<!doctype html>
<!--[if IE 9]>
<html class="lt-ie10" lang="en"> <![endif]-->
<html class="no-js" lang="en" data-useragent="Mozilla/5.0 (compatible; MSIE 10.0; Windows NT 6.2; Trident/6.0)">
<head>

  <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Github pages + jekyll + asciidoc + asciidoc diagram</title>
<meta name="description" content="">
<meta name="author" content="Jisung, Ahn">
<meta name="copyright" content="Creative Commons license">

<meta property="og:site_name"           content="narusas's blog" >
<meta property="og:title"               content="Github pages + jekyll + asciidoc + asciidoc diagram" >
<meta property="og:type"                content="article" >
<meta property="og:description"         content="SW,IT에 대해 끄적입니다" >
<meta property="og:url"                 content="https://narusas.github.io/2018/03/12/Github-page-with-asciidoc.html" >
<meta property="og:image"               content="https://narusas.github.io/images/narusas-logo.png" >

<meta property="article:published_time" content="2018-03-12T00:00:00+00:00" >
<meta property="article:author"         content="https://narusas.github.io/about/" >




<link rel="stylesheet" href="../../../css/foundation.css">
<link rel="stylesheet" href="../../../css/font-awesome.css">
<link rel="stylesheet" href="../../../css/coderay.css">
<link rel="stylesheet" href="../../../css/asciidoctor.css">
<link rel="stylesheet" href="../../../css/narusas.css">
<script src="../../../js/vendor/modernizr.js"></script>
<script src="../../../js/vendor/jquery.js"></script>
<script src="../../../js/toc.js"></script>


</head>
<body>

<!-- Nav Bar -->
<nav class="top-bar" data-topbar>
    <ul class="title-area">
        <!-- Title Area -->
        <li class="name">
            <h1>
                <a href="../../../">narusas's blog</a>

            </h1>
        </li>
        <li class="toggle-topbar menu-icon"><a href="#"><span>Menu</span></a></li>
    </ul>
</nav>
<!-- End Nav -->


<!-- Main Page Content and Sidebar -->

<div class="row">

    <!-- Main Blog Content -->
    <div class="large-12 columns" role="content">

        <h1>Github pages + jekyll + asciidoc + asciidoc diagram</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>2018-03-12</p>
</div>
<div class="paragraph">
<p>Markdown이 간단한 블로깅을 하기에 좋은 도구입니다만, 문법의 혼란과 github에서 지원하는 플러그인의 제한등이 다른 해결책을 찾아 헤메다 보면  asciidoc 에 오게 됩니다.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="환경">환경</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Github</p>
<div class="ulist">
<ul>
<li>
<p>draft repository:</p>
</li>
<li>
<p>대표 페이지 repository: username.github.io</p>
</li>
</ul>
</div>
</li>
<li>
<p>작성  PC</p>
<div class="ulist">
<ul>
<li>
<p>jekyll 구동환경</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="작성환경_만들기">작성환경 만들기</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="install_ruby">install ruby</h3>
<div class="sect3">
<h4 id="현재_버전_확인">현재 버전 확인</h4>
<div class="literalblock">
<div class="content">
<pre>which ruby
  /usr/bin/ruby  기본 설치되어 있는 루비</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="rvm_설치">rvm 설치</h4>
<div class="literalblock">
<div class="content">
<pre>rmv(ruby version manager)를 설치합니다.</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>\curl -sSL https://get.rvm.io | bash -s stable
rvm reload
rvm list known 으로 확인</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>rvm install ruby-2.4
rvm use 2.4
which ruby
 /Users/narusas/.rvm/rubies/ruby-2.4.1/bin/ruby</pre>
</div>
</div>
<div class="paragraph">
<p>짜잔 rvm 버전으로 루비가 바뀌었어요</p>
</div>
<div class="paragraph">
<p>이제 필요한 gem 을 설치합니다.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>gem install bundler
gem install travis</pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="작업용_repo_생성">작업용 repo 생성</h3>
<div class="paragraph">
<p>github에서 저장소 생성.</p>
</div>
<div class="paragraph">
<p>이때 <a href="https://github.com/asciidoctor/jekyll-asciidoc-quickstart" class="bare">https://github.com/asciidoctor/jekyll-asciidoc-quickstart</a> 를 fork 받는게 빠르다.</p>
</div>
<div class="paragraph">
<p>fork 받은 프로젝트의 이름을 변경한다.</p>
</div>
<div class="paragraph">
<p>blogdraft 정도로 이름을 변경한다</p>
</div>
<div class="paragraph">
<p>소스를 내려받는다</p>
</div>
<div class="literalblock">
<div class="content">
<pre>git clone [repo_url]</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="gemfile_생성">Gemfile 생성</h3>
<div class="paragraph">
<p>Gemfile 을 열어 빠진 것을 추가한다</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>source 'https://rubygems.org'

gem 'jekyll', '~&gt; 3.7.0'
gem 'coderay', '~&gt; 1.1.0'
gem 'rake-jekyll', '~&gt; 1.1.0'
gem 'jekyll-plantuml', '~&gt; 1.1'
gem 'jekyll-diagrams'

group :jekyll_plugins do
  gem 'jekyll-asciidoc', '~&gt; 2.0.1'
  gem 'asciidoctor-diagram'

end</code></pre>
</div>
</div>
<div class="paragraph">
<p>아마도  jekyll-plantuml, jekyll-diagrams, asciidoctor-diagram 정도가 빠져있을 것이다</p>
</div>
<div class="paragraph">
<p>변경한후에 설치를 수행한다
  bundle install</p>
</div>
</div>
<div class="sect2">
<h3 id="글_작성">글 작성</h3>
<div class="paragraph">
<p>이 이후에  글 작성은  _posts   폴더에 만들면 된다. 일반적인  jekyll 문서처럼 만들되 확장자만  .adoc  으로 주면 된다.</p>
</div>
</div>
<div class="sect2">
<h3 id="퍼블리싱용_repo_생성">퍼블리싱용 repo 생성</h3>
<div class="paragraph">
<p>github에서 저장소 생성.</p>
</div>
<div class="paragraph">
<p>이때 username.github.io 로 생성하면 독립적인 도메인을 받아서  <a href="http://username.github.io" class="bare">http://username.github.io</a>  로 접속할수 있게 된다.</p>
</div>
<div class="paragraph">
<p>세팅에 가서 github pages  설정을 활성화 시킨다</p>
</div>
</div>
<div class="sect2">
<h3 id="github_token_생성">github token  생성</h3>
<div class="paragraph">
<p>github가 asciidoc 을 지원하지 않기 때문에 travis 를 통해 빌드 하기 위해서는  github 에 푸시할 권한이 필요하다. 이를 위해 인증 토큰을 만들어야 한다.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Profie &#8594; Settings &#8594; Developer settings &#8594; Personal access tokens에 가서</p>
</li>
<li>
<p>Generate new token  을 누르고</p>
</li>
<li>
<p>public_repo  에 체크한후</p>
</li>
<li>
<p>적당한 이름을 주고 생성한다</p>
</li>
<li>
<p>생성된 인증 토큰은 잘 보관할것(두번다시 못봄)</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="travis_설정">travis 설정</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="https://travis-ci.org" class="bare">https://travis-ci.org</a>   에 가서  계정을 만든다</p>
</li>
<li>
<p>프로필 페이지로 간다</p>
</li>
<li>
<p>드래프트 저장소를 찾아 스위치를 켠다.</p>
</li>
<li>
<p>저장소를 클릭해서 들어간 페이지에서  settings에 들어간다</p>
</li>
<li>
<p>“Build only if .travis.yml is present.” 를 활성화한다.</p>
</li>
<li>
<p>환경변수를 추가한다.</p>
</li>
<li>
<p>gh_repo  퍼블리싱용 저장소 URL</p>
</li>
<li>
<p>gh_user  github 계정</p>
</li>
<li>
<p>gh_pw  아까 발행한 github token</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="draft_저장소에_파일_추가">draft 저장소에 파일 추가</h2>
<div class="sectionbody">
<div class="paragraph">
<p>다음 두 파일은 최상단 폴더에 추가한다</p>
</div>
<div class="listingblock">
<div class="title">travis.yml 추가</div>
<div class="content">
<pre class="CodeRay highlight"><code>language: ruby
sudo: false
script: chmod +x sync.sh &amp;&amp; ./sync.sh
addons:
  apt:
    packages:
    - graphviz</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">sync.sh  추가</div>
<div class="content">
<pre class="CodeRay highlight"><code>bundle exec jekyll build

rm -fR /tmp/publish
mkdir -p /tmp/publish
cp -r _site/* /tmp/publish

rm -fR /tmp/master
mkdir -p /tmp/master
cd /tmp/master

git clone https://${gh_user}:${gh_pw}@github.com/${gh_user}/${gh_repo}
cd ${gh_repo}
git rm . -r
cp -r /tmp/publish/* ./
git add .
git commit -m "updated"
git push</code></pre>
</div>
</div>
<div class="paragraph">
<p>두파일을 커밋하고 푸시한다.</p>
</div>
<div class="sect2">
<h3 id="travis_가서_동작하는지_확인">travis 가서 동작하는지 확인</h3>
<div class="paragraph">
<p>빌드에 문제가 없으면  <a href="http://username.github.io" class="bare">http://username.github.io</a>  를 방문해서 정상적으로 나오는지 확인해본다</p>
</div>
</div>
</div>
</div>

    </div>
    <span>Tags:
      
    </span>

    <!-- End Main Content -->

    <!-- Sidebar -->



    <!-- End Sidebar -->

<!-- End Main Content and Sidebar -->


<div id="disqus_thread"></div>
<script>

/**
*  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
*  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/
/*
var disqus_config = function () {
this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
};
*/
(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');
s.src = 'https://narusass-blog.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>


<!-- Footer -->

<footer class="row">
    <div class="large-12 columns">
        <hr>
        <div class="row">
            <div class="large-12 columns">
                  <a rel="license" href="http://creativecommons.org/licenses/by/4.0/"><img alt="크리에이티브 커먼즈 라이선스" style="border-width:0" src="https://i.creativecommons.org/l/by/4.0/88x31.png" /></a><br /><br /><br /><br />
                  이 저작물은 <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">크리에이티브 커먼즈 저작자표시 4.0 국제 라이선스</a>에 따라 이용할 수 있습니다.
            </div>
        </div>
    </div>
</footer>



<script src="../../../js/foundation.min.js"></script>
<script>
$(document).foundation();
var doc = document.documentElement;
doc.setAttribute('data-useragent', navigator.userAgent);
</script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-117947705-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-117947705-1');
</script>

</body>
</html>
